var allEmbeds=[],currentEmbedIndex=0;
function slidesLiveEmbedBox(){var a=this;this.xmlhttp=5;this.presentationID=38889556;this.width=960;this.height=100;this.videoSlideRatio=-1;this.zoomingOn=this.forceLightbox=!0;this.startSlide=1;this.bgColor="#1E1E1E";this.playerContainer=document.createElement("div");this.lightboxShadow=document.createElement("div");this.lightboxClose=document.createElement("div");this.lightboxDisplayed=!1;this.hasSlides=this.hasVideo=!0;this.mediaID=this.mediaType="";this.isPaid=!1;this.playerURL="http://slideslive.com/bundles/player/Player_5_THC.swf";
this.presentationJsonApiUrl="http://slideslive.com/embedjsonapi/";this.embedPresentation=function(b,c,d,e,f,g){a.printLog("Embeding presentation"+b);"undefined"!==typeof b&&(a.presentationID=b);"undefined"!==typeof c&&(a.width=c);"undefined"!==typeof d&&(a.videoSlideRatio=d);"undefined"!==typeof e&&(a.forceLightbox=e);"undefined"!==typeof f&&(a.zoomingOn=f);"undefined"!==typeof g&&(a.startSlide=g);a.createPlayerContainer()};this.createPlayerContainer=function(){a.printLog("creating container");a.playerContainer.style.width=
a.width+"px";a.playerContainer.style.height=a.height+"px";a.playerContainer.style.color="white";a.playerContainer.setAttribute("id",a.presentationID);a.getPresentationData();for(var b=document.getElementsByTagName("script"),c=document.getElementById("sle81767"),d=0;d<b.length;++d)-1!=b[d].innerHTML.indexOf("embedPresentation("+a.presentationID)&&(c=b[d]);c.parentNode.insertBefore(a.playerContainer,c)};this.resizePlayerContainer=function(b){a.hasSlides&&!a.hasVideo&&(b=3*parseInt(a.playerContainer.style.width)/
4);a.height=b;a.printLog(a.height);a.playerContainer.style.height=a.height+"px"};this.createPlayerHtml=function(b,c){"undefined"==typeof b&&(b=a.width);var d="hasVideo="+a.hasVideo+"&hasSlides="+a.hasSlides+"&presentationID="+a.presentationID+"&mediaType="+a.mediaType+"&mediaID="+a.mediaID+"&widthScale="+b+"&isEmbed=true&isPaid="+a.isPaid+"&videoSlideRatio="+a.videoSlideRatio+"&zoomingOn="+a.zoomingOn+"&startSlide="+a.startSlide;c&&(d+="&autoplay=true");if("transparent"==a.bgColor||c)var e='<param name="wmode" value="transparent">',
f='wmode="transparent"';else e='<param name="bgcolor" value="'+a.bgColor+'">',f='bgcolor="'+a.bgColor+'"';return'<object type="application/x-shockwave-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="100%" height="100%"><param name="movie" value="'+a.playerURL+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><param name="flashvars" value="'+d+'"></param>'+e+'<embed src="'+a.playerURL+'" '+f+' flashvars="'+d+'" type="application/x-shockwave-flash" width="100%" height="100%" pluginspage="http://www.macromedia.com/go/getflashplayer"  allowscriptaccess="always" allowfullscreen="true"></embed></object>'};
this.getPresentationData=function(){a.xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.xmlhttp.open("GET",a.presentationJsonApiUrl+a.presentationID,!0);a.xmlhttp.onreadystatechange=a.serverResponseProcess;a.xmlhttp.send()};this.serverResponseProcess=function(){if(4==a.xmlhttp.readyState&&200==a.xmlhttp.status){var b=a.xmlhttp.responseText,c=JSON.parse(b)[0];a.printLog(b);a.hasVideo=c.hasVideo;a.hasSlides=c.hasSlides;a.mediaType=c.mediaType;a.mediaID=c.mediaID;
a.isPaid=c.isPaid}a.playerContainer.innerHTML=a.createPlayerHtml()};this.hideLightBox=function(){a.lightboxDisplayed=!1;a.lightboxShadow.style.display="none";var b=document.getElementsByTagName("script"),c=document.getElementById("sle81767");a.playerContainer.style.width=a.width+"px";a.playerContainer.style.marginLeft="0px";a.playerContainer.style.marginRight="0px";a.playerContainer.innerHTML=a.createPlayerHtml();for(var d=0;d<b.length;++d)-1!=b[d].innerHTML.indexOf("embedPresentation("+a.presentationID)&&
(c=b[d]);c.parentNode.insertBefore(a.playerContainer,c)};this.displayLightBox=function(){console.log("LIGHTBOX DISPLAYYY");if(800<=a.width||!a.forceLightbox||a.lightboxDisplayed)return!1;a.lightboxDisplayed=!0;document.onkeypress=function(b){b=window.event||b;27==b.keyCode&&a.hideLightBox()};a.hasVideo?(lbPlayerWidth=Math.round(0.8*window.innerWidth),lbPlayerHeight=500):(lbPlayerHeight=Math.round(0.9*window.innerHeight),lbPlayerWidth=Math.round(4*lbPlayerHeight/3),console.log("Audioslideshow, width: "+
lbPlayerWidth+"height: "+lbPlayerHeight));a.lightboxShadow.style.width="100%";a.lightboxShadow.style.height="100%";a.lightboxShadow.style.backgroundColor="#000";a.lightboxShadow.style.backgroundColor="rgba(0, 0, 0, 0.8)";a.lightboxShadow.style.display="block";a.lightboxShadow.style.position="fixed";a.lightboxShadow.style.zIndex="9999";a.lightboxShadow.style.left="0px";a.lightboxShadow.style.top="0px";a.lightboxClose.addEventListener("click",a.hideLightBox,!0);a.lightboxClose.addEventListener("mouseover",
a.lightUpCloseButton);a.lightboxClose.addEventListener("mouseout",a.lightDownCloseButton);a.lightboxClose.style.width="50px";a.lightboxClose.style.height="50px";a.lightboxClose.style.backgroundImage="url('http://slideslive.com/bundles/close-big.png')";a.lightboxClose.style.backgroundRepeat="no-repeat";a.lightboxClose.style.backgroundPosition="50% 15px";a.lightboxClose.style.cursor="pointer";a.lightboxClose.style.display="block";a.lightboxClose.style.position="fixed";a.lightboxClose.style.zIndex="9999";
a.lightboxClose.style.right="0px";a.lightboxClose.style.top="0px";a.playerContainer.style.width=lbPlayerWidth+"px";a.playerContainer.style.height=lbPlayerHeight+"px";a.playerContainer.style.marginTop="50px";a.playerContainer.style.marginLeft="auto";a.playerContainer.style.marginRight="auto";document.body.appendChild(a.lightboxShadow);a.lightboxShadow.appendChild(a.playerContainer);a.lightboxShadow.appendChild(a.lightboxClose);a.playerContainer.innerHTML=a.createPlayerHtml(lbPlayerWidth,!0)};this.lightUpCloseButton=
function(){a.lightboxClose.style.backgroundPosition="50% -28px"};this.lightDownCloseButton=function(){a.lightboxClose.style.backgroundPosition="50% 15px"};this.printLog=function(a){console.log(a)}}function createSlidesLiveBox(){var a=new slidesLiveEmbedBox;allEmbeds[currentEmbedIndex]=a;currentEmbedIndex++;return a}function resizeEmbedBridge(a,b){for(var c=0;c<allEmbeds.length;c++)allEmbeds[c].presentationID==b&&allEmbeds[c].resizePlayerContainer(a)}
function slFirstPlayBridge(a){console.log("test play fired - "+a);for(var b=0;b<allEmbeds.length;b++)allEmbeds[b].presentationID==a&&allEmbeds[b].displayLightBox()};